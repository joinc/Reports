{% extends "base.html" %}
{% load i18n %}{% load static from staticfiles %}

{% block html_title %}{{ breadcrumb }}{% endblock %}

{% block html_body %}
    <br />
    <div class="container-fluid">
        <div class="row">
            <div class="col-auto mr-auto">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'index' %}">Главная</a></li>
                    <li class="breadcrumb-item active">{% ifnotequal breadcrumb '' %}{{ breadcrumb }}{% endifnotequal %}</li>
                </ol>
            </div>
        </div>
        <div class="shadow p-3 mb-5 bg-white rounded">
            <form method='post' action='{% url 'report_save' report.id %}'>
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">Краткое наименование:</label>
                    <div class="col-sm-10">
                        {{ report_form.report_title_short }}
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">Полное наименование:</label>
                    <div class="col-sm-10">
                        {{ report_form.report_title_long }}
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">Заголовок (<a href="http://www.apsolyamov.ru/files/html-table-generator.html" target="_blank">Генератор</a>):</label>
                    <div class="col-sm-10">
                        {{ report_form.report_header }}
                    </div>
                </div>
                {% csrf_token %}
                <button class="btn btn-info" type="submit">Сохранить таблицу</button>
            </form>
        </div>
        <div class="shadow p-3 mb-5 bg-white rounded">
            <form method='post' action='{% url 'column_save' report.id %}'>
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">Тип данных:</label>
                    <div class="col-sm-10">
                        {{ column_form.column_type }}
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">Наименование столбца:</label>
                    <div class="col-sm-10">
                        {{ column_form.column_title }}
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label">Формула значения итого:</label>
                    <div class="col-sm-10">
                        {{ column_form.column_total }}
                    </div>
                </div>
                {% csrf_token %}
                <button class="btn btn-info" type="submit">Добавить столбец</button>
            </form>
        </div>
        <div class="shadow p-3 mb-5 bg-white rounded">
        <h2>{{ report.TitleLong }}</h2>
        <table class="table table-hover table-bordered">
            <thead class="bg-info text-white">
                {% autoescape off %}{{ report.Header }}{% endautoescape %}
                <tr>
                    <td>1</td>
                    {% for column in column_list %}
                        <td>{{ forloop.counter|add:1 }}</td>
                    {% endfor %}
                    <td>#</td>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Ответственное лицо</td>
                    {% for column in column_list %}
                        <td>{{ column.Title }} <a class="btn btn-outline-danger btn-sm" href="{% url 'column_delete' column.id %}" role="button">Удалить</a></td>
                    {% endfor %}
                    <td>#</td>
                </tr>
            </tbody>
        </table>
        </div>
    </div>
{% endblock %}
